2025-11-06 19:41:38.028 +01:00 [INF] User profile is available. Using '/Users/jaraazad/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2025-11-06 19:41:38.514 +01:00 [INF] Applying migration '20251024065541_InitialCreate'.
2025-11-06 19:41:38.550 +01:00 [INF] Applying migration '20251101105657_AddIdentitySupport'.
2025-11-06 19:41:38.627 +01:00 [INF] Applying migration '20251103080324_UpdateNextQuestionSceneDeleteBehavior'.
2025-11-06 19:41:39.557 +01:00 [INF] Now listening on: https://localhost:7025
2025-11-06 19:41:39.558 +01:00 [INF] Now listening on: http://localhost:5262
2025-11-06 19:41:39.562 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-06 19:41:39.563 +01:00 [INF] Hosting environment: Development
2025-11-06 19:41:39.563 +01:00 [INF] Content root path: /Users/jaraazad/Desktop/Jam
2025-11-06 19:41:39.835 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7025/ - null null
2025-11-06 19:41:39.864 +01:00 [INF] Executing endpoint 'Jam.Controllers.HomeController.Index (Jam)'
2025-11-06 19:41:39.874 +01:00 [INF] Route matched with {action = "Index", controller = "Home", page = "", area = ""}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller Jam.Controllers.HomeController (Jam).
2025-11-06 19:41:39.886 +01:00 [WRN] [HomeController -> Index] Auth cookie invalid or user no longer exists. Redirecting to login.
2025-11-06 19:41:39.889 +01:00 [INF] AuthenticationScheme: Identity.Application signed out.
2025-11-06 19:41:39.890 +01:00 [INF] AuthenticationScheme: Identity.External signed out.
2025-11-06 19:41:39.890 +01:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2025-11-06 19:41:39.891 +01:00 [INF] Executing LocalRedirectResult, redirecting to /Identity/Account/Login.
2025-11-06 19:41:39.893 +01:00 [INF] Executed action Jam.Controllers.HomeController.Index (Jam) in 17.4933ms
2025-11-06 19:41:39.893 +01:00 [INF] Executed endpoint 'Jam.Controllers.HomeController.Index (Jam)'
2025-11-06 19:41:39.900 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7025/ - 302 0 null 66.9545ms
2025-11-06 19:41:39.908 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7025/Identity/Account/Login - null null
2025-11-06 19:41:39.934 +01:00 [INF] Executing endpoint '/Account/Login'
2025-11-06 19:41:39.946 +01:00 [INF] Route matched with {page = "/Account/Login", area = "Identity", action = "", controller = ""}. Executing page /Account/Login
2025-11-06 19:41:39.956 +01:00 [INF] Executing handler method Jam.Areas.Identity.Pages.Account.LoginModel.OnGetAsync - ModelState is "Valid"
2025-11-06 19:41:39.957 +01:00 [INF] AuthenticationScheme: Identity.External signed out.
2025-11-06 19:41:39.957 +01:00 [INF] Executed handler method OnGetAsync, returned result .
2025-11-06 19:41:39.959 +01:00 [INF] Executing an implicit handler method - ModelState is "Valid"
2025-11-06 19:41:39.959 +01:00 [INF] Executed an implicit handler method, returned result Microsoft.AspNetCore.Mvc.RazorPages.PageResult.
2025-11-06 19:41:40.011 +01:00 [INF] Executed page /Account/Login in 64.8692ms
2025-11-06 19:41:40.011 +01:00 [INF] Executed endpoint '/Account/Login'
2025-11-06 19:41:40.014 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7025/Identity/Account/Login - 200 null text/html; charset=utf-8 105.1372ms
2025-11-06 19:41:40.104 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7025/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js - null null
2025-11-06 19:41:40.104 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7025/lib/jquery-validation/dist/jquery.validate.min.js - null null
2025-11-06 19:41:40.107 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7025/lib/jquery-validation/dist/jquery.validate.min.js - 404 0 null 28.6372ms
2025-11-06 19:41:40.107 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7025/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js - 404 0 null 3.4668ms
2025-11-06 19:41:40.108 +01:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7025/lib/jquery-validation/dist/jquery.validate.min.js, Response status code: 404
2025-11-06 19:41:40.108 +01:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7025/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js, Response status code: 404
2025-11-06 19:41:41.048 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7025/Identity/Account/Login - application/x-www-form-urlencoded 236
2025-11-06 19:41:41.106 +01:00 [INF] Executing endpoint '/Account/Login'
2025-11-06 19:41:41.107 +01:00 [INF] Route matched with {page = "/Account/Login", area = "Identity", action = "", controller = ""}. Executing page /Account/Login
2025-11-06 19:41:41.140 +01:00 [INF] Executing handler method Jam.Areas.Identity.Pages.Account.LoginModel.OnPostAsync - ModelState is "Valid"
2025-11-06 19:41:41.265 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2025-11-06 19:41:41.265 +01:00 [INF] User logged in.
2025-11-06 19:41:41.266 +01:00 [INF] Executed handler method OnPostAsync, returned result Microsoft.AspNetCore.Mvc.LocalRedirectResult.
2025-11-06 19:41:41.266 +01:00 [INF] Executing LocalRedirectResult, redirecting to /.
2025-11-06 19:41:41.266 +01:00 [INF] Executed page /Account/Login in 159.26ms
2025-11-06 19:41:41.266 +01:00 [INF] Executed endpoint '/Account/Login'
2025-11-06 19:41:41.267 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7025/Identity/Account/Login - 302 0 null 219.3861ms
2025-11-06 19:41:41.271 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7025/ - null null
2025-11-06 19:41:41.272 +01:00 [INF] Executing endpoint 'Jam.Controllers.HomeController.Index (Jam)'
2025-11-06 19:41:41.272 +01:00 [INF] Route matched with {action = "Index", controller = "Home", page = "", area = ""}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller Jam.Controllers.HomeController (Jam).
2025-11-06 19:41:41.327 +01:00 [INF] Executing ViewResult, running view Index.
2025-11-06 19:41:41.370 +01:00 [INF] Executed ViewResult - view Index executed in 44.0777ms.
2025-11-06 19:41:41.373 +01:00 [INF] Executed action Jam.Controllers.HomeController.Index (Jam) in 100.2578ms
2025-11-06 19:41:41.374 +01:00 [INF] Executed endpoint 'Jam.Controllers.HomeController.Index (Jam)'
2025-11-06 19:41:41.377 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7025/ - 200 null text/html; charset=utf-8 106.1771ms
2025-11-06 19:41:44.483 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7025/StoryEditing/EditStory?storyId=1 - null null
2025-11-06 19:41:44.518 +01:00 [INF] Executing endpoint 'Jam.Controllers.StoryEditingController.EditStory (Jam)'
2025-11-06 19:41:44.527 +01:00 [INF] Route matched with {action = "EditStory", controller = "StoryEditing", page = "", area = ""}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] EditStory(Int32) on controller Jam.Controllers.StoryEditingController (Jam).
2025-11-06 19:41:44.550 +01:00 [INF] Executing ViewResult, running view EditStory.
2025-11-06 19:41:44.631 +01:00 [INF] Executed ViewResult - view EditStory executed in 82.4134ms.
2025-11-06 19:41:44.633 +01:00 [INF] Executed action Jam.Controllers.StoryEditingController.EditStory (Jam) in 106.3618ms
2025-11-06 19:41:44.635 +01:00 [INF] Executed endpoint 'Jam.Controllers.StoryEditingController.EditStory (Jam)'
2025-11-06 19:41:44.637 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7025/StoryEditing/EditStory?storyId=1 - 200 null text/html; charset=utf-8 153.5467ms
2025-11-06 19:41:45.482 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7025/StoryEditing/EditQuestionScenes?storyId=1 - null null
2025-11-06 19:41:45.485 +01:00 [INF] Executing endpoint 'Jam.Controllers.StoryEditingController.EditQuestionScenes (Jam)'
2025-11-06 19:41:45.490 +01:00 [INF] Route matched with {action = "EditQuestionScenes", controller = "StoryEditing", page = "", area = ""}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] EditQuestionScenes(Int32) on controller Jam.Controllers.StoryEditingController (Jam).
2025-11-06 19:41:45.559 +01:00 [INF] Executing ViewResult, running view EditQuestionScenes.
2025-11-06 19:41:45.633 +01:00 [INF] Executed ViewResult - view EditQuestionScenes executed in 74.5477ms.
2025-11-06 19:41:45.659 +01:00 [INF] Executed action Jam.Controllers.StoryEditingController.EditQuestionScenes (Jam) in 168.348ms
2025-11-06 19:41:45.659 +01:00 [INF] Executed endpoint 'Jam.Controllers.StoryEditingController.EditQuestionScenes (Jam)'
2025-11-06 19:41:45.659 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7025/StoryEditing/EditQuestionScenes?storyId=1 - 200 null text/html; charset=utf-8 176.9727ms
2025-11-06 19:41:48.204 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7025/StoryEditing/DeleteQuestion?storyId=1&questionSceneId=3 - application/x-www-form-urlencoded 225
2025-11-06 19:41:48.232 +01:00 [INF] Executing endpoint 'Jam.Controllers.StoryEditingController.DeleteQuestion (Jam)'
2025-11-06 19:41:48.238 +01:00 [INF] Route matched with {action = "DeleteQuestion", controller = "StoryEditing", page = "", area = ""}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] DeleteQuestion(Int32, Int32) on controller Jam.Controllers.StoryEditingController (Jam).
2025-11-06 19:41:48.299 +01:00 [ERR] An exception occurred in the database while saving changes for context type 'Jam.DAL.StoryDbContext'.
System.InvalidOperationException: Unable to save changes because a circular dependency was detected in the data to be saved: 'QuestionScene [Modified] ForeignKeyConstraint { 'NextQuestionSceneId' } <-
QuestionScene [Deleted] Index { 'NextQuestionSceneId' } <-
QuestionScene [Modified]To show additional information call 'DbContextOptionsBuilder.EnableSensitiveDataLogging'.'.
   at Microsoft.EntityFrameworkCore.Utilities.Multigraph`2.ThrowCycle(List`1 cycle, Func`2 formatCycle, Func`2 formatException)
   at Microsoft.EntityFrameworkCore.Utilities.Multigraph`2.TopologicalSortCore(Boolean withBatching, Func`4 canBreakEdges, Func`2 formatCycle, Func`2 formatException)
   at Microsoft.EntityFrameworkCore.Utilities.Multigraph`2.BatchingTopologicalSort(Func`4 canBreakEdges, Func`2 formatCycle, Func`2 formatException)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.TopologicalSort(IEnumerable`1 commands)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.BatchCommands(IList`1 entries, IUpdateAdapter updateAdapter)+MoveNext()
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
System.InvalidOperationException: Unable to save changes because a circular dependency was detected in the data to be saved: 'QuestionScene [Modified] ForeignKeyConstraint { 'NextQuestionSceneId' } <-
QuestionScene [Deleted] Index { 'NextQuestionSceneId' } <-
QuestionScene [Modified]To show additional information call 'DbContextOptionsBuilder.EnableSensitiveDataLogging'.'.
   at Microsoft.EntityFrameworkCore.Utilities.Multigraph`2.ThrowCycle(List`1 cycle, Func`2 formatCycle, Func`2 formatException)
   at Microsoft.EntityFrameworkCore.Utilities.Multigraph`2.TopologicalSortCore(Boolean withBatching, Func`4 canBreakEdges, Func`2 formatCycle, Func`2 formatException)
   at Microsoft.EntityFrameworkCore.Utilities.Multigraph`2.BatchingTopologicalSort(Func`4 canBreakEdges, Func`2 formatCycle, Func`2 formatException)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.TopologicalSort(IEnumerable`1 commands)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.BatchCommands(IList`1 entries, IUpdateAdapter updateAdapter)+MoveNext()
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-11-06 19:41:48.368 +01:00 [ERR] [SceneRepository -> DeleteQuestionScene] Error deleting QuestionScene with id 3
System.InvalidOperationException: Unable to save changes because a circular dependency was detected in the data to be saved: 'QuestionScene [Modified] ForeignKeyConstraint { 'NextQuestionSceneId' } <-
QuestionScene [Deleted] Index { 'NextQuestionSceneId' } <-
QuestionScene [Modified]To show additional information call 'DbContextOptionsBuilder.EnableSensitiveDataLogging'.'.
   at Microsoft.EntityFrameworkCore.Utilities.Multigraph`2.ThrowCycle(List`1 cycle, Func`2 formatCycle, Func`2 formatException)
   at Microsoft.EntityFrameworkCore.Utilities.Multigraph`2.TopologicalSortCore(Boolean withBatching, Func`4 canBreakEdges, Func`2 formatCycle, Func`2 formatException)
   at Microsoft.EntityFrameworkCore.Utilities.Multigraph`2.BatchingTopologicalSort(Func`4 canBreakEdges, Func`2 formatCycle, Func`2 formatException)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.TopologicalSort(IEnumerable`1 commands)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.BatchCommands(IList`1 entries, IUpdateAdapter updateAdapter)+MoveNext()
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Jam.DAL.SceneDAL.SceneRepository.DeleteQuestionScene(Int32 questionSceneId, Nullable`1 previousSceneId) in /Users/jaraazad/Desktop/Jam/DAL/SceneDAL/SceneRepository.cs:line 447
2025-11-06 19:41:48.370 +01:00 [INF] Executing RedirectResult, redirecting to /StoryEditing/EditQuestionScenes?storyId=1.
2025-11-06 19:41:48.370 +01:00 [INF] Executed action Jam.Controllers.StoryEditingController.DeleteQuestion (Jam) in 131.7241ms
2025-11-06 19:41:48.370 +01:00 [INF] Executed endpoint 'Jam.Controllers.StoryEditingController.DeleteQuestion (Jam)'
2025-11-06 19:41:48.370 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7025/StoryEditing/DeleteQuestion?storyId=1&questionSceneId=3 - 302 0 null 187.6803ms
2025-11-06 19:41:48.397 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7025/StoryEditing/EditQuestionScenes?storyId=1 - null null
2025-11-06 19:41:48.422 +01:00 [INF] Executing endpoint 'Jam.Controllers.StoryEditingController.EditQuestionScenes (Jam)'
2025-11-06 19:41:48.422 +01:00 [INF] Route matched with {action = "EditQuestionScenes", controller = "StoryEditing", page = "", area = ""}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] EditQuestionScenes(Int32) on controller Jam.Controllers.StoryEditingController (Jam).
2025-11-06 19:41:48.452 +01:00 [INF] Executing ViewResult, running view EditQuestionScenes.
2025-11-06 19:41:48.514 +01:00 [INF] Executed ViewResult - view EditQuestionScenes executed in 61.6145ms.
2025-11-06 19:41:48.514 +01:00 [INF] Executed action Jam.Controllers.StoryEditingController.EditQuestionScenes (Jam) in 91.4063ms
2025-11-06 19:41:48.514 +01:00 [INF] Executed endpoint 'Jam.Controllers.StoryEditingController.EditQuestionScenes (Jam)'
2025-11-06 19:41:48.514 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7025/StoryEditing/EditQuestionScenes?storyId=1 - 200 null text/html; charset=utf-8 117.5611ms
